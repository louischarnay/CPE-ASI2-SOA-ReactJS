<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:amq="http://activemq.apache.org/schema/core"
       xsi:schemaLocation="
           http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
           http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd">

    <!-- ActiveMQ Broker Configuration -->
    <amq:broker brokerName="localhost" dataDirectory="${activemq.data}">
        
        <!-- Enable transport connectors -->
        <amq:transportConnectors>
            <!-- Openwire protocol for JMS -->
            <amq:transportConnector name="openwire" uri="tcp://0.0.0.0:61616"/>
            
            <!-- STOMP protocol for web clients -->
            <amq:transportConnector name="stomp" uri="stomp://0.0.0.0:61613"/>
            
            <!-- HTTP connector for ActiveMQ Web Console -->
            <amq:transportConnector name="http" uri="http://0.0.0.0:8161"/>
        </amq:transportConnectors>

        <!-- Virtual topic configuration to bridge JMS and STOMP -->
        <amq:destinationInterceptors>
            <amq:virtualDestinationInterceptor>
                <amq:virtualDestinations>
                    <!-- Define virtual topic for 'message' -->
                    <amq:virtualTopic name="message" prefix="Consumer.*." postfix=""/>
                </amq:virtualDestinations>
            </amq:virtualDestinationInterceptor>
        </amq:destinationInterceptors>
    </amq:broker>
</beans>
